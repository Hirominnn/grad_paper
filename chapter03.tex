\chapter{分析手法}
\label{chap:method}
\fancyhf{}
\rhead{\thepage}
\lhead{第\ref{chap:method}章　分析手法}
\cfoot{\thepage}
本章では，
事前の知識分類を用いずに生徒の知識獲得を予測し，抽出された知識分類を分析する手法について説明する．

まず，分析手法全体の流れを概説し，手法全体が３つのブロックから構成されることを述べる．
その後，まず，既存の知識獲得予測の手法において，Deep Knowledge Tracingが最適であることを述べる．
次に，分析対象とする問題回答ログデータにおける要件として，
データセットが大規模であること，
数学に関する問題回答ログであること，
抽出した知識分類と比較可能な，既存の知識分類を有すること
について説明する．
その後，既存のDeep Knowledge Tracingの手法の拡張として，
深層学習の最適化の過程で知識分類を自動抽出するためのモデル設計について述べ，
最後に，モデルから抽出された知識構造から，知識分類を作成し，既存の知識分類と比較する手法について述べる．


\vvspace


まず，分析手法全体の流れを説明する．
手法は，データセットの作成，知識獲得予測に基づく問題と知識分類の関係行列の算出，知識分類の抽出と検証の３つのブロックから構成される．

本論文が扱う，生徒の知識獲得予測において，
生徒が知識を獲得しているか否かの評価には，通常，その生徒の問題への回答の正誤を評価する．
生徒の問題への回答結果は，その問題が問う知識を，生徒が既に獲得しているか否かを表現していると捉えることができるため，
回答結果が正解であれば，該当の知識を既に獲得しており，
回答結果が不正解であれば，該当の知識を未だ獲得していないと捉えることができる．
したがって，分析では，問題回答ログデータを対象データに用いる．


問題回答ログデータからデータセットを作成するにあたり，
比較検証に用いるため，知識獲得の予測に利用できる複数のデータセットを，後述の要件に基づいて作成する．


作成した複数のデータセットに対し，知識獲得予測を行う過程で知識分類を学習できる手法を適用し，
問題と知識分類の関係行列を算出する．
手法の基礎となっているのはDeep Knowledge Tracingであり，
この手法が知識分類を学習しながら知識獲得予測を行う上で最適な手法であること，
また，同手法の本研究における拡張方法についても後述する．


最後に，算出された問題と知識分類の関係行列を離散表現に改めることで，
モデルが学習した知識分類を抽出し，
抽出された分類が紐づく問題の回答傾向の特徴や，既存の知識分類との比較を通じて，抽出された分類を定量的・定性的に分析する．



以上が，分析手法全体の流れである．
以降では，
データセット作成におけるデータの要件，
知識獲得予測に用いる手法の基礎，
知識分類を学習させるための拡張，
%問題と知識分類の関係行列の算出方法，
知識分類の抽出と検証
について順に詳述する．


\section{データセット作成におけるデータの要件}
本論文が扱う生徒の知識獲得予測においては，
前述の通り，生徒の問題回答ログデータをデータセットとして用いる．
生徒の問題への回答結果は，その問題が問う知識を，生徒が既に獲得しているか否かを表現していると捉えることができるため，
回答結果が正解であれば，該当の知識を既に獲得しており，
回答結果が不正解であれば，該当の知識を未だ獲得していないと捉えることができるからである．

問題回答ログデータから作成するデータセットは，下記の要件を満たす必要がある．
１) データセットが大規模であること
２) 比較検証できるデータセットが複数存在すること
３）問題に既存の知識分類が割り当てられていること

まず，データセットが大規模である必要について説明する．
一般に，深層学習は大量のデータを元に特徴的な表現を抽出するため，
深層学習モデルを十分に学習させるには，大規模なデータが必要である．
データ数が不足すると，データの潜在的な特徴を十分に学習できないことに加え，
汎用性の低い特徴まで過剰に学習してしまう「過学習」に陥りやすくなる．
これは，深層学習モデルの一つであるRNNを活用するDeep Knowledge Tracingについても同様である\cite{piech2015deep}．
したがって，大規模なデータを有することがデータセットの要件の一つとなる．


また，深層学習によって知識獲得の予測を行う本研究においては，単にデータ数が多いだけでなく，
分析対象にできる問題や生徒について，十分な数を確保できることが必要である．
例えば，一度しか回答されていない問題については，
その問題の正答や誤答によって，生徒の知識状態がどのように変化するかが観察できないため，分析に適していない．
また，十分な数の生徒のデータがないと，特定の生徒の学習傾向が強く反映され，
より一般的に知識獲得を説明する知識分類を学習できないおそれがある．


さらに，回答された問題に，既存の知識分類が割り当てられていることが必要である．
一般的な知識獲得予測では，問題によって評価される知識を，事前に専門家によってつけられた知識分類に基づいて定義している．
本論文では，この「問題によって評価される知識」を，モデル自身が学習して抽出した知識分類に基づいて評価するように設計している．
この設計は，専門家による事前の知識分類が，知識獲得を的確に説明できる分類であるという根拠がないという前提に立っている．
本論文では，専門家の事前分類を所与のものとせずに，問題の回答ログデータのみを深層学習に適用することで，
知識獲得の過程を最もよく説明する知識分類を抽出することを目的としている．
その抽出した知識分類の妥当性を検証するためにも，既存の知識分類が存在することが必要である．



\section{知識獲得予測に用いる手法の基礎}
本研究で用いる手法は，数ある知識獲得予測の手法の中でも，Deep Knowledge Tracing（以下，DKT）を元に設計されている．
DKTを拡張する手法が，本研究の目的を達成する上で最適な手法であることを，以下の二点に基づいて説明する．
1)知識間の関係性が，知識獲得予測の文脈において定量的に検証され，抽出されるべきこと，
2)知識獲得予測が，複数の知識間の影響関係や，知識獲得の時系列性を考慮して行われるべきこと，


まず，知識間の関係性については，知識獲得予測の過程で抽出されるものと，そうでないものがある．
後者については，
専門家が作成するという手法や，
テキスト解析により概念関係ネットワークを構築するという手法\cite{chen2008mining}がある．
しかし，これらの手法は，
専門家や研究者が立てた仮説に基づいた定性的なものであり，
実際の生徒の学習過程をよく説明するものであるという定量的な根拠はない．

問題回答正誤の分析により知識の構造化を行う方法では，
2つの問題$i$と$j$の間で問題$i$が正解後と不正解後の問題$j$の正解率の差と着手順序を基に知識は構造化される．
しかし，この手法は2つの問題$i$と$j$の関係性のみを考慮しており，他の問題との関係性は独立だと見なされている．
得られた知識間関係は2つ知識の間についてのものを線形に合算したものであり，
複雑で密接に関係している複数の知識の獲得順序や影響関係を捉えているものではない．

一方で，知識間の関係性の抽出を，知識獲得を予測する過程で行うものは，
生徒の知識状態と行動を元に，知識の獲得を予測しているため，
生徒の学習過程を反映した知識間関係を表現している可能性が高い．

したがって，
知識間関係を定量的に抽出する手法としては，
知識獲得を予測する過程で知識間関係を抽出する手法に絞る．


次に，知識獲得予測については，
複数の知識の影響関係や知識獲得の時系列性を考慮するものと，そうでないものがある．
% BKT的なものとDKT的なものがある
後者については，
複数の知識を独立なものとして，known/unkonwnという状態を遷移するBKTの手法や，
過去の回答の結果をまとめてxxxするPFAの手法などがある．
しかし，BKTの手法は，複数の知識を独立なものとして捉えるため，複数の知識からなる複雑な知識状態を捉えきれず，
また，PFAの手法も，十分な時間が立った後の回答も，直前の回答も一つの過去の回答として捉えるため，
生徒の時間に沿った知識獲得の状態を，現実的に捉えきれていない．

一方，DKTは，深層学習モデルの隠れ層の更新により，
複数の知識間の影響関係や，知識獲得の時系列性を考慮して知識獲得を予測しているので，
より現実に沿った知識間関係を抽出できる可能性が高い．

現に\cite{piech2015deep}で，
既にDKTによって知識間関係を抽出できることが報告されており，
複雑で密接に関係している複数の知識の獲得順序や影響関係を捉えている可能性が高く，
DKTを利用することが最適であると考えられる．


また，PFAとDKTのいずれの手法も知識間関係を考慮して予測に利用しているが，DKTの方が有効性が高いと考える．
なぜなら，
\cite{piech2015deep}では言及されていなかったが，
DKTはPFAの拡張になっているためである．
DKTはRNNを利用しており，
\begin{eqnarray}
{\bf h}_t & = & f({\bf x}_t, {\bf h}_{t-1})\\
{\bf p}_t & = & \sigma({\bf h}_{t-1} \cdot {\bf W}_{hp} + {\bf b}_p)
\end{eqnarray}
で与えられる．
一方でPFAは
\begin{eqnarray}
	p(i, j \in KCs, s, f) & = & \sigma( \beta _j + \sum_{k \in KCs}(\gamma_k s_{i, k} + \rho _k f_{i, k}) )
\end{eqnarray}
で与えられる．
したがって，
\begin{eqnarray}
\label{eq:discussion-func}
	f({\bf x}_t, {\bf h}_{t-1}) &=& {\bf x}_t + {\bf h}_{t-1}\\
	{\bf h}_{0} & = & [0, 0, \cdots , 0]
\end{eqnarray}
とすると，
${\bf h_t}$がこれまでの各問題についての正答回数を表現するベクトルと各問題についての誤答回数を表現するベクトルを結合したベクトルになるが， 
これは，ベクトル${\bf s}$と${\bf f}$を結合したものと同じである．
したがって，
PFAはDKT内部のRNNの繰り返しの部分を表現する関数$f$を式\ref{eq:discussion-func}にした特殊なケースであり，
DKTはPFAの拡張になっている．


\section{知識分類を学習させるための拡張}
本研究のモデルを設計する上で基礎となるDKTを，本研究の目的を達成するために拡張する方法を説明する．


DKTのモデルにおいては，使用するデータは問題回答ログデータであるが，
モデルへの入力は，既存の知識分類に落とし込まれ，どの知識分類に属する問題に回答したかが入力される．
これは，既存の知識分類の中で，生徒がどのように知識獲得をしていくかを予測することを前提にしているためであるが，
この前提は，本研究の，問題の回答のみから，知識分類を学習させるという目的を満たさない．

よって本研究では，モデルへの入力は問題回答のままにとどめ，
生徒が次にどの問題に正解するかを予測する過程において，
生徒の知識状態を，モデル自身が定義した知識空間で解釈させることで，
最終的に，問題回答の正誤予測を最適化するような知識分類を抽出させる．

こうして抽出された知識分類は，結果的に知識獲得の文脈で最適化されていると考えることができ，
既存の知識分類と比較することで，その性質を解釈することができる．


以下では，具体的なモデルの設計について述べる．
まず，DKTのモデル構造と大きく異なる点は，
DKTでは入力が直接隠れ層へ伝達されるのに対し，
本研究のモデルは，まず抽出目的のタグ空間への写像を行う．
ここで言うタグ空間とは，問題回答の正誤からモデルが解釈した，その生徒の知識状態を反映した空間である．
モデル自身が定義した，問題とタグの関係性に基づき，
問題に正答すると，問題と関係性が強いタグほど理解度が高くなるように知識状態が変化し，
逆に誤答すると，問題と関係性の強いタグほど理解度が低くなるように知識状態が変化するよう設計されている．
知識獲得予測を最適化する過程で，モデル自身が，知識獲得を最もよく説明する，問題とタグの関係性を学習することで，
最終的に，知識獲得の文脈で最適化された問題とタグの関係性を抽出することができる．





\section{知識分類の抽出と検証}






\vvspace
以上，分析手法について述べた．
次章では，実験で利用するデータセットについて述べる．

